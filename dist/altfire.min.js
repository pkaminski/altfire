(function(window, undefined){angular.module("altfire",[]).factory("fire",["$interpolate","$q","$timeout","$rootScope","orderByFilter","fireHelpers",function(s,b,g,d,l,k){function t(a){var c=e(a.ref().toString(),a.val());a.hasChildren()&&null!==a.getPriority()&&(c[".priority"]=a.getPriority());return c}function e(a,c){var B;angular.isObject(c)?B=C(a)||c:angular.isArray(c)&&(B=C(a)||{});B&&angular.forEach(c,function(c,b){null===c||angular.isUndefined(c)||(B[b]=e(a+"/"+b,c))});return B||c}function f(a,c){if(a in u)return u[a];Object.keys(u).length>=
J&&(u={});if(angular.isString(a)){var b="https://"===a.slice(0,8);if(a&&(-1!==(b?a.slice(8):a).indexOf("//")||"/"===a.charAt(a.length-1)||"/"===a.charAt(0))){try{throw Error("Invalid path interpolation: "+a);}catch(n){if(c)throw n;console.log(n.stack.replace(/\n[^\n]*(altfire|angular(\.min)?)\.js[^\n]*$/gm,""))}return u[a]=null}if(!b){if(!h)throw Error("Relative path given and default root not specified.");a=u[a]=h+a}}return a}function x(a,c,b,n,r){function d(a){return[f(k?k(a):c,r),f(g?g(a):b,r)]}
a.$watch||(r=!0);b&&-1===c.search("#")&&(c+="/#");var k=angular.isString(c)?s(c,!1):void 0,g=angular.isString(b)?s(b,!1):void 0;!r&&a.$watch&&a.$watch(d,function(a){e&&angular.equals(a,e)||(e=null,n.apply(null,a))},!0);var e=d(a);n.apply(null,e)}function z(a,c,f,n,r,e,x){function I(){e&&(H(e),m.allowedKeys={});"viaKeys"===r||"viaValues"===r?angular.forEach(a[c],function(a,c){A([c],a)}):n&&A([],a[c]);F&&F();v&&v.destroy();delete a[c]}function h(a,c,b){var e=a.toString();y[e]||(y[e]={});y[e][c]||(y[e][c]=
[]);y[e][c].push(b);a.on(c,b)}function H(a){var c=y[a.toString()];c&&angular.forEach(c,function(c,b){angular.forEach(c,function(c){a.off(b,c)})});delete y[a.toString()]}function q(){if("via"===r)h(e,"value",function(b){n&&(A([],a[c]),delete a[c]);if(b.hasChildren())throw Error("via value of "+e+" must not be an object, ignoring: "+b.val());m.filterValue=b.val();n=new Firebase(G.replace("#",m.filterValue));D([],z)});else if("viaKeys"===r||"viaValues"===r)a[c]=a[c]||{},h(e,"value",function(a){m.filterValue=
t(a);m.filterValue?angular.forEach(m.filterValue,function(a,c){"$"!==c.charAt(0)&&l("viaKeys"===r?c:x(a),!0)}):u()}),h(e,"child_removed",function(a){l(a.name(),!1)});else if("viaIds"===r)if(a[c]=a[c]||{},m.filterValue=e,e.length)for(var b=0;b<e.length;b++)l(e[b],!0);else u()}function p(a,c){if((m.isReady||angular.isObject(c))&&!angular.isUndefined(c)){var b=w(a);c=k.fireCopy(c);angular.isObject(c)&&!angular.isArray(c)?b.update(c):b.set(c)}}function l(b,e){if(b&&!!m.allowedKeys[b]!==e)if(e)m.allowedKeys[b]=
!0,D([b],s(b));else{var f=a[c]&&a[c][b];E("child_removed",[],b);A([b],f);delete m.allowedKeys[b]}}function z(b){d.$evalAsync(function(){m.isReady?angular.isObject(b)&&angular.isObject(a[c])||(a[c]=b,v&&(v.savedScope[c]=angular.copy(b))):(a[c]=k.fireMerge(b,a[c]),u(),"bind"===f&&m.ready().then(function(){p([],a[c])}))})}function s(b){return function(e){angular.isObject(e)&&angular.isObject(a[c]&&a[c][b])||angular.isUndefined(a[c])||(a[c][b]=e,v&&(v.savedScope[c][b]=angular.copy(e)),!m.isReady&&Object.keys(m.allowedKeys).every(function(b){return a[c].hasOwnProperty(b)})&&
u(),m.isReady&&d.$evalAsync(function(){}))}}function u(){m.isReady||(m.isReady=!0,g(function(){C.resolve()}))}function w(a){var c;G&&"via"!==r?(c=new Firebase(G.replace("#",a[0])),1<a.length&&(c=c.child(a.slice(1).join("/")))):c=a.length?(n.ref?n.ref():n).child(a.join("/")):n;return c}function D(a,c){a=a||[];var b=w(a);h(b,"child_added",function(c){var b=t(c);c.hasChildren()&&D(a.concat(c.name()));E("child_added",a,c.name(),b)});h(b,"child_removed",function(c){A(a.concat(c.name()),t(c));E("child_removed",
a,c.name())});h(b,"child_changed",function(c){c.hasChildren()||E("child_changed",a,c.name(),c.val())});c&&h(b,"value",function(a){c(t(a))})}function A(a,c){a=a||[];var b=w(a);angular.isObject(c)&&angular.forEach(c,function(c,b){angular.isString(b)&&"$"===b.charAt(0)||A(a.concat(b),c)});H(b)}function E(b,e,f,n){d.$evalAsync(function(){var d=k.parsePath(c,e);switch(b){case "child_removed":k.remove(d(a),f,n);v&&k.remove(d(v.savedScope),f);break;case "child_added":case "child_changed":k.set(d(a),f,n),
v&&k.set(d(v.savedScope),f,angular.copy(n))}})}var m={},y={};x=x||angular.identity;var C=b.defer();a.$on&&a.$on("$destroy",I);m.destroy=I;m.isReady=!1;m.ready=function(){return C.promise};if(e){m.allowedKeys={};var G=n;n=null;q();m[r+"Ref"]=e}else D([],z),m.ref=n;var v,F;"bind"===f&&(v=k.makeObjectReporter(a,c,p),F=d.$watch(v.compare,angular.noop));return m}var p={},h=null,q={},w=null,u={},J=5E3;p.setDefaultConstructorMap=function(a){q=angular.copy(a);w=null};var K=function(){w||(w=[],angular.forEach(q,
function(a,c){var b=[],e=f(c,!0).replace(/\b\$[^\/]+/g,function(a){b.push(a);return"([^/]+)"});w.push({constructor:a,variables:b,regex:RegExp("^"+e.replace(/[$-.?[-^{|}]/g,"\\$&")+"$")})}));return w},C=function(a){for(var c=K(),b=0;b<c.length;b++){var e=c[b];e.regex.lastIndex=0;var f=e.regex.exec(a);if(f){a=new e.constructor;for(c=0;c<e.variables.length;c++)a[e.variables[c]]=f[c+1];return a}}};p.setDefaultRoot=function(a){angular.isString(a)||(a=a.toString());if(0!==a.search(/^https?:\/\//))throw Error("Firebase root URL must start with http(s)://, got: "+
a);"/"!==a.charAt(a.length-1)&&(a+="/");h=a;u={};w=null};p.ref=function(a,c){return new Firebase(f(s(c)(a)))};p.connectOne=function(a){function c(c){a.query&&(c=a.query(c));return c}if(!a.name)throw Error("Must provide a name for the connection.");if(1!==("bind"in a)+("pull"in a)+("once"in a)+("noop"in a))throw Error('Each connection must specify exactly one of "bind", "pull", "once" and "noop".');var e,f;angular.forEach(["bind","pull","once","noop"],function(c){c in a&&(e=c,f=a[c])});var d="ref",
k,g;angular.forEach(["via","viaKeys","viaValues","viaIds"],function(c){if(c in a){if(k)throw Error('A connection can specify at most one of "via", "viaKeys", "viaValues", and "viaIds".');k=c;"viaIds"===c?d=null:(g=a[c],d=c+"Ref")}});if(k&&("once"===e||"noop"===e))throw Error('Cannot combine via* with "once" or "noop".');if(a.viaValueExtractor&&"viaValues"!==k)throw Error('Can only use "viaValueExtractor" with "viaValues".');if("viaIds"===k&&a.query)throw Error("Cannot combine viaIds with a query.");
var h;x(a.pathScope||a.scope,f,g,function(f,n){h&&(h.destroy(),h=null);if("noop"===e&&f)h={destroy:angular.noop,isReady:!0,ready:function(){return b.when()}},h[d]=c(new Firebase(f));else if("once"===e&&f){var x=b.defer(),l=h={destroy:angular.noop,isReady:!1,ready:function(){return x.promise}};h[d]=c(new Firebase(f));h[d].once("value",function(c){h===l&&(a.scope[a.name]=t(c),h.isReady=!0,x.resolve())})}else!f||g&&!n||(h=n?z(a.scope,a.name,e,f,k,c(new Firebase(n)),a.viaValueExtractor):"viaIds"===k?
z(a.scope,a.name,e,f,k,a.viaIds):z(a.scope,a.name,e,c(new Firebase(f))))});var l={destroy:function(){h&&h.destroy()},isReady:function(){return h&&h.isReady},ready:function(){return h&&h.ready()},allowedKeys:function(){return h&&h.allowedKeys}};d&&(l[d]=function(){var a=h[d];a.ref&&(a=a.ref());arguments.length&&(a=a.child(Array.prototype.slice.call(arguments,0).join("/")));return a});k&&(l[k]=function(){return h.filterValue});return l};p.connect=function(a,c){var e={};angular.forEach(c,function(c,
b){c.scope=a;c.name=b;e[b]=p.connectOne(c)});e.$allReady=function(){var c=[],f=[];angular.forEach(e,function(a,b){"$"!==b.charAt(0)&&(c.push(b),a.ready()&&f.push(a.ready()))});return b.all(f).then(function(){var b={};angular.forEach(c,function(c){b[c]=a[c]});return b})};e.$destroyAll=function(){angular.forEach(e,function(a,c){"$"!==c.charAt(0)&&a.destroy()})};return e};p.toArrayOrderedByKey=function(a){var c=[];a&&(angular.forEach(a,function(a,b){angular.isObject(a)&&(a.$key=b,c.push(a))}),l(c,"$key"));
return c};return p}]).factory("fireHelpers",[function(){var s={remove:function(b,g){angular.isArray(b)?b.splice(g,1):b&&delete b[g]},set:function(b,g,d){b&&(b[g]=d)},parsePath:function(b,g){return function(d){d=d[b];for(var l=0,k=g.length;l<k;l++){if(angular.isUndefined(d))return;d=d[g[l]]}return d}},fireCopy:function(b){if(angular.isObject(b)){var g=angular.isArray(b)?Array(b.length):{},d;for(d in b)b.hasOwnProperty(d)&&("$"!==d.charAt(0)&&angular.isDefined(b[d]))&&(angular.isObject(b[d])?g[d]=s.fireCopy(b[d]):
g[d]=b[d]);return g}return b},fireMerge:function(b,g){if(angular.equals(b,g))return g;if(angular.isArray(b)&&angular.isArray(g))return g.concat(b);if(angular.isObject(b)&&angular.isObject(g)){for(var d in b)g[d]=b[d];return g}return(angular.isUndefined(b)||null===b)&&angular.isDefined(g)?g:b},makeObjectReporter:function(b,g,d){function l(b,f){angular.isUndefined(f)&&(f=null);b.shift();d(b,f)}function k(b,f,d,g,p){if(!d.charAt||"$"!==d.charAt(0)){p--;if(!p&&!angular.equals(b[d],f[d]))return b[d]=angular.copy(f[d]),
l(g.concat(d),f[d]);f=f[d];var h=b[d],q;if(angular.isObject(f))if(angular.isArray(f)){angular.isArray(h)||(l(g.concat(d),f),b[d]=h=f.slice());if(h.length>f.length)for(b=f.length,q=h.length;b<q;b++)l(g.concat(d,b),null);h.length=f.length;b=0;for(q=f.length;b<q;b++)k(h,f,b,g.concat(d),p)}else{if(!angular.isObject(h)||angular.isArray(h))l(g.concat(d),f),b[d]=h=angular.copy(f);for(q in f)f.hasOwnProperty(q)&&k(h,f,q,g.concat(d),p);for(q in h)f.hasOwnProperty(q)||(delete h[q],l(g.concat(d,q),null))}else f!==
h&&(b[d]=f,l(g.concat(d),f))}}var t={};t[g]=angular.copy(b[g]);return{savedScope:t,compare:function(){k(t,b,g,[],6)},destroy:function(){t&&delete t[g];t=null}}}};return s}]);
(function(){function s(b,g){angular.forEach(g,function(e,f){var g=b[f];b[f]=function(){var b=arguments[e]||angular.noop,k=Array.prototype.slice.call(arguments),h=this;k[e]=function(e){var g=b.apply(this,arguments);e&&g!==Firebase.IGNORE_ERROR&&angular.forEach(d,function(b){b(e,h,f)})};return g.apply(this,k)}});return b}function b(d){s(d,{on:2,once:2});angular.forEach(["limit","startAt","endAt"],function(g){var e=d[g];d[g]=function(){return b(e.apply(this,arguments))}});return d}function g(){if(!l){s(Firebase.prototype,
{auth:1,set:1,update:1,setWithPriority:2,setPriority:1,transaction:1});var d=Firebase.prototype.onDisconnect;Firebase.prototype.onDisconnect=function(){return s(d.apply(this,arguments),{set:1,setWithPriority:2,update:1,remove:0,cancel:0})};b(Firebase.prototype);l=!0}}Firebase.IGNORE_ERROR={};var d=[],l=!1;Firebase.onError=function(b){g();d.push(b);return b};Firebase.offError=function(b){b=d.indexOf(b);-1!==b&&d.splice(b,1)}})();}).call(window);
